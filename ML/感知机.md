# 感知机

感知机（perceptron）是二类分类的线性分类模型，其输入为实例的特征向量，输出为实例的类别，取 $+1$ 和 $–1$ 二值。感知机对应于输入空间（特征空间）中将实例划分为正负两类的分离超平面，属于判别模型。感知机学习旨在求出将训练数据进行线性划分的分离超平面，为此，导入基于误分类的损失函数，利用梯度下降法对损失函数进行极小化，求得感知机模型。感知机学习算法具有简单而易于实现的优点，分为原始形式和对偶形式。感知机预测是用学习得到的感知机模型对新的输入实例进行分类。感知机 1957 年由 Rosenblatt 提出，是神经网络与支持向量机的基础。

**定义 2.1（感知机）**　假设输入空间（特征空间）是 $\mathcal{X} \subseteq \mathbb{R}^n$，输出空间是 $\mathcal{Y} = \{+1,-1\}$。输入 $x \in \mathcal{X}$ 表示实例的特征向量，对应于输入空间（特征空间）的点；输出 $y \in \mathcal{Y}$ 表示实例的类别。由输入空间到输出空间的如下函数

$$
f(x) = \text{sign} (\langle w,x \rangle + b)
$$

称为感知机。其中，$w$ 和 $b$ 为感知机模型参数，$w \in \mathbb{R}^n$ 叫作**权值**（weight）或权值向量（weight vector），$b\in \mathbb{R}$叫作**偏置**（bias）， $\langle w,x \rangle$ 表示 $w$ 和 $x$ 的内积, 可写作 $\langle w,x \rangle = w^Tx$。$\text{sign}$ 是符号函数，即

$$
\text{sign} (x) = \begin{cases}
1 & x \geq 0\\
-1 & x < 0
\end{cases}
$$

感知机是一种线性分类模型，属于判别模型。感知机模型的假设空间是定义在特征空间中的所有线性分类模型（linear classification model）或**线性分类器**(linear classifier)，即函数集合 $\{f|f(x)＝w^Tx+b\}$。

![支撑超平面](https://i.loli.net/2018/09/08/5b93e205aeffb.png)

**定义2.2（数据集的线性可分性）**　给定一个数据集

$$
T = \{(x_1,y_1), (x_2,y_2),\cdots, (x_m,y_m)\}
$$

其中 $x_i \in \mathbb{R}^n, y_i \in \{-1, +1\}$, 如果存在某个超平面 $S: w^Tx + b = 0$ 能够将数据集的正实例点和负实例点完全正确地划分到超平面的两侧，即对所有  $y_i=+1$ 的实例 $i$，有 $w^Tx_i+b>0$，对 $y_i=-1$ 的实例 $i$，有 $w^Tx_i+b < 0$，则称数据集 $T$ 为**线性可分数据集**（linearly separable data set）；否则，称数据集 $T$  **线性不可分**。

## 感知机学习策略

假设训练数据集是线性可分的，感知机学习的目标是求得一个能够将训练集正实例点和负实例点完全正确分开的**分离超平面**。为了找出这样的超平面，即确定感知机模型参数 $w,b$，需要确定一个学习策略，即定义（经验）损失函数并将损失函数极小化。

损失函数的一个自然选择是误分类点的总数。但是，这样的损失函数不是参数 $w,b$ 的连续可导函数，不易优化。损失函数的另一个选择是误分类点到超平面 $S$ 的总距离，这是感知机所采用的。为此，首先写出输入空间 $\mathbb{R}^n$ 中任一点 $x_0$ 到超平面 $S$ 的距离：

$$
\frac{1}{||w||_2} |w^T x_0 + b|
$$

由于 $y_i = -1$ 或 $1$，所以误分类点 $x_i$ 到超平面 $S$ 的距离可以写作

$$
- \frac{1}{||w||_2} (w^T x_i + b)y_i
$$

不考虑 $\frac{1}{||w||_2}$，就得到感知机学习的损失函数

$$
L(w,b) = - \sum_{x_i \in M} (w^T x_i + b)y_i
$$

其中 $M$ 是超平面 $S$ 的误分类点集合.

![感知机基本算法](https://i.loli.net/2018/09/09/5b93f2560a24b.png)

![捕获](https://i.loli.net/2018/09/09/5b93f4a9009ec.png)
![捕获1](https://i.loli.net/2018/09/09/5b93f4b73bbde.png)
![捕获2](https://i.loli.net/2018/09/09/5b93f4c5bc989.png)
![捕获3](https://i.loli.net/2018/09/09/5b93f4d2f0bcf.png)
![捕获4](https://i.loli.net/2018/09/09/5b93f4de57eb8.png)

编程实现: [感知机实现](./感知机实现.ipynb)